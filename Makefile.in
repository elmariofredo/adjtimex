#### Start of system configuration section. ####
 srcdir = .
VPATH = .

CFLAGS = @CFLAGS@
prefix = @prefix@
man1dir=@mandir@/man1
exec_prefix = @exec_prefix@
bindir=$(exec_prefix)/bin

INSTALL=@INSTALL@

# Extension (not including `.') for the manual page filenames.
manext = 8
# Where to put the manual pages.
mandir = $(prefix)/man/man$(manext)

#### End of system configuration section. ####

SHELL = /bin/sh

SRC = adjtimex.c adjtimex.8 mat.c mat.h install-sh configure.in \
 configure Makefile.in README adjtimex.lsm COPYING COPYRIGHT ChangeLog

MISC = Makefile adjtimex.8 README  adjtimex.lsm
DISTFILES = $(MISC) $(SRCS)

all: adjtimex

adjtimex: adjtimex.c mat.o
	$(CC) $(CFLAGS) -I. -o adjtimex adjtimex.c mat.o -lm
	
mat.o: mat.c
	$(CC) $(CFLAGS) -c mat.c

install: all
	$(INSTALL) -g bin -m 755 -o root adjtimex $(bindir)/adjtimex
	-$(INSTALL) -g man -m 444 -o root $(srcdir)/adjtimex.8 \
		$(mandir)/adjtimex.$(manext)

uninstall:
	rm -f $(bindir)/adjtimex $(mandir)/adjtimex.$(manext)

clean: 
	rm -f core *.o
veryclean: clean
	rm -f adjtimex

shar: $(SRC)
	distname=`sed -e '/Id.*adjtimex.c/!d' \
		-e 's/[^0-9]*\([0-9.]*\).*/adjtimex-\1/' \
		-e q adjtimex.c`; \
	shar $(SRC) >$$distname.shar 

dist: $(SRC)
	distname=`sed -e '/Id.*adjtimex.c/!d' \
		-e 's/[^0-9]*\([0-9.]*\).*/adjtimex-\1/' \
		-e q adjtimex.c`; \
	rm -fr $$distname; \
	mkdir $$distname; \
	for file in $(SRC); do \
	  ln $$file $$distname/$$file \
	  || { echo copying $$file instead; cp -p $$file $$distname/$$file;}; \
	done; \
	chmod -R a+rX $$distname; \
	tar -chz -f $$distname.tar.gz $$distname; \
	rm -fr $$distname
